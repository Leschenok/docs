# Пример 1. Синхронизация каталога организаций между ИС



Система T2Plus Интеграция может быть использована для обмена данными информационных систем организации с серверами расчетов или другими отдельными приложениями, реализующими различные трудоемкие алгоритмы обработки данных (расчет плана, расчет зарплаты, расчет остатков и т. д.). Информация о текущих результатах расчетов может передаваться через систему в приложения визуализации процесса обработки данных. Один из вариантов использования Т2 Интеграция, это синхронизация каталогов содержащих одинаковые данные в разных информационных системах организации. Для примера можно взять каталог контрагентов в информационных системах (ИС) Т2.ERP,Т2.SPM,Т2.APM.

Расположение каталога:
Т2.ERP Управление договорами \ Настройка \ Заполнение каталогов \ Организации и банки, 
Т2.SPM - Основная НСИ \ Взаимоотношения \ Контрагенты, 
Т2.APM - Каталоги \ Взаимоотношения \ Контрагенты. ИС - Источник ERP ИС - приемники SPM,APM. 

Объектом обмена данными, информация о котором хранится в информационных системах (Сущность) является Организация. Организация имеет следующие параметры:

Код.
Наименование
Полное наименование.
ИНН.
КПП.
ОКПО.
ОГРН.

Изменения основных параметров ИС - приемников должны быть заблокированы. В ИС - приемниках могут быть дополнительные параметры не совпадающие с параметрами ИС - Источника изменение таких параметров разрешено и не синхронизируется. Передача данных инициируется по следующим событиям:

**В БД Т2.ERP добавлена новая запись в каталог организаций и банков.**
*Порядок формирования данных для передачи:*
Сформировать объект сущности Организация на основании добавленной записи.
*Порядок обработки полученных данных в  Т2.SPM:*
1.Для объекта сущности Организация создать и заполнить соответствующий объект ИС «Контрагент».
2.Для сформированного объекта ИС «Контрагент» установить:
•Статус = Опубликован.
*Порядок обработки полученных данных в :*
1.Для объекта сущности Организация создать и заполнить соответствующий объект ИС «Контрагент».
2.Для сформированного объекта ИС «Контрагент» установить:
•Статус = Опубликован.
**В БД Т2.ERP изменена запись в каталоге организаций и банков.**
*Порядок формирования данных для передачи:Т2.APM*
Сформировать объект сущности Организация на основании измененной записи.
*Порядок обработки полученных данных в Т2.SPM:*
1.Для объекта сущности Организация найти (при необходимости – создать) и заполнить соответствующий объект ИС «Контрагент».
2.Для обрабатываемого объекта ИС «Контрагент» установить:
•Статус = Опубликован.
*Порядок обработки полученных данных в Т2.APM:*
1.Для объекта сущности Организация найти (при необходимости – создать) и заполнить соответствующий объект ИС «Контрагент».
2.Для обрабатываемого объекта ИС «Контрагент» установить:
•Статус = Опубликован.
**В БД Т2.ERP удалена запись в каталоге организаций и банков.**
*Порядок формирования данных для передачи:*
Сформировать данные с информацией об удалении объекта сущности Организация на основании удаляемой записи.
*Порядок обработки полученных данных в Т2.SPM:*
Для объекта сущности Организация  найти соответствующий объект ИС «Контрагент» и удалить его (пометить как удаленный).
*Порядок обработки полученных данных в Т2.APM:*
Для объекта сущности Организация найти соответствующий объект ИС «Контрагент» и удалить его (пометить как удаленный).
